<%
''IP Check :: '' [db_log].[dbo].tbl_partner_login_log 에서 IP 로그 확인가능.
function fnChkAllowIpLog(bltype, refip)
    dim sqlStr
    dim scrname : scrname = Request.ServerVariables("SCRIPT_NAME")
    dim strMethod : strMethod = Request.ServerVariables("REQUEST_METHOD")
    dim qryStr
    If strMethod = "POST" Then
        qryStr = (Request.Form)  ''Server.HTMLEncode
    else
        qryStr = Request.QueryString
    end if

    sqlStr = "exec db_log.dbo.sp_TEN_ChkAllowIpLog '"&bltype&"','"&session("ssBctID")&"','"&refip&"','"&scrname&"','"&replace(qryStr,"'","")&"','"&LEFT(strMethod,1)&"'"
    dbget_CS.Execute sqlStr
end function

dim TMP_check_UserIP
TMP_check_UserIP = request.ServerVariables("REMOTE_ADDR")

''210.92.223.194 - 210.92.223.253 사내 고정(구) - 사용중지.
''125.128.177.13                    이팀 - 사용중지.
''221.138.98.95, 58.77.2.17         민정성 - 사용중지.
''59.7.192.159                      서팀 - 사용중지.

''61.252.133.2   - 61.252.133.126 사내 고정.
''115.94.163.43  - 115.94.163.45  사내 유동(Xpeed office)
''203.84.251.209 - '203.84.251.214 물류 고정.
'' 203.84.253.58 - 물류 유동 2015/03/24 03/26 삭제  ,"203.84.253.58" _    

''222.111.61.89, 59.5.170.49        물류 유동.
''115.93.29.58 - 115.93.29.60 물류 엑스피드
''112.221.93.178 - 180 유아러걸  - 사용중지.
''115.91.233.123 물류 (3PL)
''223.62.169.24 , 61.72.241.14 두타
'' 59.5.52.207 대학로
'' 39.115.24.204 김포롯데
'' 222.110.25.49 이대 엘큐브점 2017/01/12
'' 61.73.50.7 이대 엘큐브점 2017/03/09
'' 61.73.86.179 이대 엘큐브점 2017/03/15
' 14.40.95.157 건대
'/ 221.155.223.196 일산	'/2018.04.11
'218.146.160.217 부산점 '/2017.06.08
'211.53.55.89 DDP점	'/2017.12.19
'' 116.42.227.138 <= 124.58.8.230 <= 58.127.43.37 강희란 재택 임시 (2016/02/29)
'61.37.16.3 고양스타필드점	'/2017.08.18
' 112.171.18.242 이은주 재택

dim C_ALLOWIPLIST
C_ALLOWIPLIST = Array(  "203.84.251.209","203.84.251.210","203.84.251.211","203.84.251.212","203.84.251.213","203.84.251.214" _
                        ,"115.94.163.42","115.94.163.43","115.94.163.44","115.94.163.45","115.94.163.46","218.146.160.217" _
                        ,"115.93.29.58","115.93.29.59","115.93.29.60" _
                        ,"115.91.233.126","211.53.55.89","115.91.233.124" _
                        ,"61.252.133.2","61.252.133.3","61.252.133.4","61.252.133.5","61.252.133.6" _
                        ,"61.252.133.7","61.252.133.8","61.252.133.9","61.252.133.10","61.252.133.11" _
                        ,"61.252.133.12","61.252.133.13","61.252.133.14","61.252.133.15","61.252.133.16" _
                        ,"61.252.133.17","61.252.133.18","61.252.133.19","61.252.133.20","61.252.133.21" _
                        ,"61.252.133.22","61.252.133.23","61.252.133.24","61.252.133.25","61.252.133.26" _
                        ,"61.252.133.27","61.252.133.28","61.252.133.29","61.252.133.30","61.252.133.31" _
                        ,"61.252.133.32","61.252.133.33","61.252.133.34","61.252.133.35","61.252.133.36" _
                        ,"61.252.133.37","61.252.133.38","61.252.133.39","61.252.133.40","61.252.133.41" _
                        ,"61.252.133.67","61.252.133.68","61.252.133.69","61.252.133.70" _
                        ,"61.252.133.71","61.252.133.72","61.252.133.73","61.252.133.74","61.252.133.75" _
                        ,"61.252.133.76","61.252.133.77","61.252.133.78","61.252.133.79","61.252.133.80" _
                        ,"61.252.133.81","61.252.133.82","61.252.133.83","61.252.133.84","61.252.133.96" _
                        ,"61.252.133.103","61.252.133.104","61.252.133.105","61.252.133.106","61.252.133.107" _
                        ,"61.252.133.113","61.252.133.114","61.252.133.115","61.252.133.116","61.252.133.117","61.252.133.118" _
                        ,"61.252.133.121","61.252.133.122","61.252.133.123","61.252.133.124","61.252.133.125","61.252.133.102" _
                        ,"115.91.233.123","115.93.29.62","61.73.86.179","14.40.95.157","211.46.21.145","61.37.16.3" _
                        ,"223.62.169.24","61.72.241.14","59.5.52.207", "116.42.227.138","39.115.24.204","221.155.223.196","112.171.18.242" _
                      )

dim IPCheckOK
dim tmp_ip_i, tmp_ip_buf1
IPCheckOK = false
for tmp_ip_i=0 to UBound(C_ALLOWIPLIST)
    tmp_ip_buf1 = C_ALLOWIPLIST(tmp_ip_i)
    if (TMP_check_UserIP=tmp_ip_buf1) then
        IPCheckOK = true
        Exit For
    end if
next

if (application("Svr_Info")="Dev") then
    Call fnChkAllowIpLog("A",TMP_check_UserIP)
else
    if (Not IPCheckOK) then
        Call fnChkAllowIpLog("B",TMP_check_UserIP)
    	response.write "승인된 페이지가 아닙니다. 관리자 문의요망 [" & TMP_check_UserIP & "]"
    	response.end
    else
        Call fnChkAllowIpLog("A",TMP_check_UserIP)
    end if
end if

%>