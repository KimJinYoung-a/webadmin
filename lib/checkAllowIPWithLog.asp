<%
''IP Check :: '' [db_log].[dbo].tbl_partner_login_log 에서 IP 로그 확인가능.
function fnChkAllowIpLog(bltype, refip)
    dim sqlStr
    dim scrname : scrname = Request.ServerVariables("SCRIPT_NAME")
    dim strMethod : strMethod = Request.ServerVariables("REQUEST_METHOD")
    dim qryStr
    If strMethod = "POST" Then
        qryStr = (Request.Form)  ''Server.HTMLEncode
    else
        qryStr = Request.QueryString
    end if

    sqlStr = "exec db_log.dbo.sp_TEN_ChkAllowIpLog '"&bltype&"','"&session("ssBctID")&"','"&refip&"','"&scrname&"','"&replace(qryStr,"'","")&"','"&LEFT(strMethod,1)&"'"
    dbget.Execute sqlStr
end function

dim TMP_check_UserIP
TMP_check_UserIP = request.ServerVariables("REMOTE_ADDR")

''210.92.223.194 - 210.92.223.253 사내 고정(구) - 사용중지.
''125.128.177.13                    이팀 - 사용중지.
''221.138.98.95, 58.77.2.17         민정성 - 사용중지.
''59.7.192.159                      서팀 - 사용중지.
''61.252.133.2   - 61.252.133.126 사내(동숭동) 고정. => 삭제
''115.94.163.43  - 115.94.163.45  사내 유동(Xpeed office) => 삭제

''121.78.103.2   - 121.78.103.126 사내(연건동) 고정.
''112.218.65.240 - 112.218.65.254  사내 유동(Xpeed office)
''110.11.187.233 - 사내 유동(WiFi)
''203.84.251.209 - '203.84.251.214 물류 고정.
'' 203.84.253.58 - 물류 유동 2015/03/24 3/25 삭제  ,"203.84.253.58" _

''222.111.61.89, 59.5.170.49        물류 유동.
''115.93.29.58 - 115.93.29.60 물류 엑스피드
''112.221.93.178 - 180 유아러걸  - 사용중지.
''115.91.233.123 물류 (3PL)
''223.62.169.24 , 61.72.241.14 두타
'' 59.5.52.207=> 59.5.54.57 =>59.5.52.25=> 59.5.52.31=> 59.5.52.47 => 59.5.52.109대학로 =>175.123.149.94
'' 118.221.62.51 김포롯데	'/2017.06.21
'' 119.206.18.23 전주 팝업스토아
'' 175.252.136.132 명동

'' 119.192.0.192 이문재 임시 2014/08/02
'' 175.209.38.216 ''GS 매장 임시 2014/12/09
'' 210.223.20.106 명동AK몰
'' "61.252.133.92" ''모의해킹 (2015/06/08) => 삭제
'' 123.109.32.109 이요한 임시 (2015/06/12) => 삭제
'' 175.253.18.49 이요한 임시 (2015/06/12) => 삭제
' 112.171.18.242 이은주 재택 => 삭제
'' 119.192.0.105 이문재 재택 임시. (2015/12/29)
'' 116.42.227.138 <= 124.58.8.230 <= 58.127.43.37 강희란 재택 임시 (2016/02/29)
'' 222.110.25.49 이대 엘큐브점 2017/01/12
'' 61.73.50.7 이대 엘큐브점 2017/03/09
'' 61.73.86.179 이대 엘큐브점 2017/03/15
'/ 221.155.223.196 일산	'/2018.04.11
' 14.40.95.157 건대
'218.146.160.217 부산점 '/2017.06.08
'211.53.55.89 DDP점	'/2017.12.19
'61.37.16.3 => 210.216.195.7 고양스타필드점	'/2019.09.16



dim C_ALLOWIPLIST
C_ALLOWIPLIST = Array(  "203.84.251.209","203.84.251.210","203.84.251.211","203.84.251.212","203.84.251.213" _
                        ,"115.93.29.58","115.93.29.59","115.93.29.60","115.93.29.61","115.93.29.62" _
                        ,"115.91.233.126","211.53.55.89","115.91.233.124" _
                        ,"115.91.233.123","61.73.86.179","14.40.95.157","211.46.21.145","210.216.195.7" _
                        ,"223.62.169.24","61.72.241.14","175.123.149.94","118.221.70.31","119.206.18.23","175.252.136.132" _
                        ,"119.192.0.105","119.192.0.192","210.223.20.106", "116.42.227.138", "118.221.62.51","221.155.223.196","218.146.160.217" _
						,"121.78.103.1","121.78.103.2","121.78.103.3","121.78.103.4","121.78.103.5","121.78.103.6","121.78.103.7","121.78.103.8" _
						,"121.78.103.9","121.78.103.10","121.78.103.11","121.78.103.12","121.78.103.13","121.78.103.14","121.78.103.15","121.78.103.16" _
						,"121.78.103.17","121.78.103.18","121.78.103.19","121.78.103.20","121.78.103.21","121.78.103.22","121.78.103.23","121.78.103.24" _
						,"121.78.103.25","121.78.103.26","121.78.103.27","121.78.103.28","121.78.103.29","121.78.103.30","121.78.103.41","121.78.103.42" _
						,"121.78.103.43","121.78.103.44","121.78.103.45","121.78.103.46","121.78.103.47","121.78.103.48","121.78.103.49","121.78.103.50" _
						,"121.78.103.51","121.78.103.52","121.78.103.53","121.78.103.54","121.78.103.55","121.78.103.56","121.78.103.57","121.78.103.58" _
						,"121.78.103.59","121.78.103.60","121.78.103.61","121.78.103.62","121.78.103.63","121.78.103.64" _
						,"112.218.65.240","112.218.65.241","112.218.65.242","112.218.65.243","112.218.65.244","112.218.65.245" _
						,"112.218.65.246","112.218.65.247","112.218.65.248","112.218.65.249","112.218.65.250","112.218.65.251" _
						,"112.218.65.252","112.218.65.253","112.218.65.254","110.11.187.233" _
						,"192.168." _
                      )

dim IPCheckOK
dim tmp_ip_i, tmp_ip_buf1
IPCheckOK = false
for tmp_ip_i=0 to UBound(C_ALLOWIPLIST)
    tmp_ip_buf1 = C_ALLOWIPLIST(tmp_ip_i)
    if (TMP_check_UserIP=tmp_ip_buf1) then
        IPCheckOK = true
        Exit For
    end if
	if UBound(Split(tmp_ip_buf1, ".")) < 3 then
		if Left(TMP_check_UserIP, Len(tmp_ip_buf1)) = tmp_ip_buf1 then
			IPCheckOK = true
			Exit For
		end if
	end if
next

if (Not IPCheckOK) then
    ' 로그인 권한 IP 관리 DB화   ' 2019.09.20 한용민
	IPCheckOK = fncheckAllowIPWithByDB("Y", "", "")
end if

if (application("Svr_Info")="Dev") then
    Call fnChkAllowIpLog("A",TMP_check_UserIP)
else
    if (Not IPCheckOK) then
        Call fnChkAllowIpLog("B",TMP_check_UserIP)
    	response.write "승인된 페이지가 아닙니다. 관리자 문의요망 [" & TMP_check_UserIP & "]"
    	response.end
    else
        Call fnChkAllowIpLog("A",TMP_check_UserIP)
    end if
end if

%>
